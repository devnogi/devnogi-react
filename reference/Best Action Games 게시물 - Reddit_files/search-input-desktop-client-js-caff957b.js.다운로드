import"./faceplate-search-input-25da50f8.js";import{gR as e,_ as t,e as o,a4 as s}from"./shell-47d14d7f.js";import{x as r}from"./icon-feb8496e.js";import{a as n,R as i,S as a}from"./base-8feb0ef9.js";import"./text-input-b514202a.js";import"./community-picker-991cd74c.js";import"./age-gate-standalone-client-js-2c5a180c.js";import"./constants-d95f0f33.js";import"./utils-86ec2fed.js";import"./search-telemetry-tracker-112dfc64.js";import"./post-consume-tracker-d64c63f6.js";import"./links-d16464b2.js";import"./search-flair-expandable-list-66cc9b8a.js";import"./index-b63a3443.js";import"./unicode-utils-5dcb5928.js";import"./shreddit-spoiler-e5c275e2.js";import"./search-helpers-862fb185.js";import"./search-dynamic-id-ebdf400c.js";import"./list-item-header-bb203cd0.js";import"./ad-event-tracker-3c7eb816.js";import"./index-e02ebca1.js";import"./overflow-menu-actions-b3104045.js";import"./distinguished-tags-fcb25dd7.js";import"./shreddit-dynamic-ad-link-af1fcb96.js";import"./suggested-search-queries-client-js-67fe4ec6.js";import"./faceplate-expandable-section-helper-1f5f91e3.js";import"./faceplate-auto-height-animator-e3edd750.js";import"./content-tags-94c4765a.js";import"./pdp-seeker-cafdafe5.js";class h{constructor(t){this.onKeyDown=e=>{const t="Escape"===e.key,o="Tab"===e.key,s=Boolean(o&&this.host.shadowRoot&&this.host.input&&this.host.shadowRoot.activeElement===this.host.input),r=o&&!e.shiftKey;t&&e.preventDefault(),(t||s||r)&&this.host.handleBlur()},this.getKeyboardNavigableDropdownItems=()=>{const t=`[role="menuitem"],summary[aria-controls*="${e}"]`,o=[];return[this.host.suggestedSearchResultsContainer,this.host.recentSearchesContainer,this.host.trendingSearchesContainer,this.host.typeaheadResultsContainer].forEach((e=>{if(!e)return;e.querySelectorAll(t).forEach((e=>{const t=null!==e.offsetParent&&e.offsetHeight>0,s="SUMMARY"===e.tagName,r=e.closest("faceplate-expandable-section-helper");t&&(s||!r||r.open)&&o.push(e)}))})),o},this.handleRecentSearchTabKeyNavigation=e=>{const t=e.target.querySelector(".recent-search-item-delete-button");e.shiftKey&&e.target.className.includes("recent-search-item-delete-button")?(e.target.closest('[role="menuitem"]')?.focus(),e.preventDefault(),e.stopPropagation()):!e.shiftKey&&t&&(t.focus(),e.preventDefault(),e.stopPropagation())},this.handleDropdownKeyDown=e=>{const t=e.target?.closest(`#${n}`);if("Tab"===e.key&&t)this.handleRecentSearchTabKeyNavigation(e);else if("ArrowDown"===e.key||"ArrowUp"===e.key){e.preventDefault();const t=e.target,o=this.getKeyboardNavigableDropdownItems();let s=-1;o.forEach(((e,o)=>{e===t&&(s=o)}));const r="ArrowDown"===e.key?s+1:s-1,n=s>=0&&s<o.length?o[r]:void 0;n?n.focus():this.focusSearchInputWithArrowKeys()}},this.host=t}hostConnected(){this.host.addEventListener("keydown",this.onKeyDown)}hostDisconnected(){this.host.removeEventListener("keydown",this.onKeyDown)}handleKeyDown(e){if(!["ArrowDown","ArrowUp"].includes(e.key))return;e.preventDefault();const t=this.getKeyboardNavigableDropdownItems();0!==t.length&&("ArrowDown"===e.key?t[0].focus():"ArrowUp"===e.key&&t[t.length-1].focus())}focusSearchInputWithArrowKeys(){const e=this.host.input?.shadowRoot?.querySelector("input");e?.focus();const t=e?.value.length;t&&e?.setSelectionRange(t,t)}}let d=class extends i{constructor(){super(...arguments),this.handleDropdownKeyDown=e=>{super.handleDropdownKeyDown(e),this.keyboardNavigationController?.handleDropdownKeyDown(e)}}handleFocus(){super.handleFocus(),this.keyboardNavigationController||(this.keyboardNavigationController=new h(this),this.addController(this.keyboardNavigationController))}handleKeyDown(e){super.handleKeyDown(e),this.keyboardNavigationController?.handleKeyDown(e)}render(){return r` <div class="reddit-search-bar rounded-5 w-[inherit] box-border ${s({"shadow-sm":this.isFocused,"bg-neutral-background-strong":this.isFocused,"bg-secondary-background":!this.isFocused})}" data-faceplate-tracking-context="${JSON.stringify(this.searchTelemetryData)}"> <div class="${s({"pb-[.5rem]":this.showDropdown&&!this.isSearchScopeEnabled,"pb-xs":this.showDropdown&&this.isSearchScopeEnabled,"border-b-sm":this.showDropdown,"border-t-0":this.showDropdown,"border-r-0":this.showDropdown,"border-l-0":this.showDropdown,"border-solid":this.showDropdown,"border-neutral-border-weak":this.showDropdown})}"> <form autocomplete="off" class="flex relative items-center text-neutral-content-strong" @submit="${this.handleSubmit}"> ${this.renderSearchInput(!0)} </form> </div> <div class="max-h-[calc(100vh-var(--shreddit-header-height)-15px-10px)] overflow-y-auto overflow-x-hidden m-t ${s({hidden:!this.showDropdown})}" id="${a}"> ${this.renderDropdownContent(!0)} </div> </div> `}};d=t([o("reddit-search-large")],d);
